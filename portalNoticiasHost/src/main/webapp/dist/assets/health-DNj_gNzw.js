import{j as D,d as g,i as C,u as y,_ as S,c as h,o as c,b as p,a as s,t as l,F as v,x as N,g as b,r as H,f,e as _,n as w,z as $}from"./index-BApcu5iX.js";import"./preload-helper-CLcXU_4U.js";class k{separator;constructor(){this.separator="."}checkHealth(){return D.get("management/health")}transformHealthData(e){const a=[];return this.flattenHealthData(a,null,e.components),a}getBaseName(e){if(e)return e.split(".")[0]}getSubSystemName(e){if(e){const a=e.split(".");a.splice(0,1);const n=a.join(".");return n?` - ${n}`:""}}addHealthObject(e,a,n,i){const o={name:i,details:void 0,error:void 0},m={};let d=!1;for(const u in n)if(Object.hasOwn(n,u)){const r=n[u];u==="status"||u==="error"?o[u]=r:this.isHealthObject(r)||(m[u]=r,d=!0)}return d&&(o.details=m),(a||d||o.error)&&e.push(o),o}flattenHealthData(e,a,n){for(const i in n)if(Object.hasOwn(n,i)){const o=n[i];this.isHealthObject(o)&&(this.hasSubSystem(o)?(this.addHealthObject(e,!1,o,this.getModuleName(a,i)),this.flattenHealthData(e,this.getModuleName(a,i),o)):this.addHealthObject(e,!0,o,this.getModuleName(a,i)))}return e}getModuleName(e,a){return e&&a?e+this.separator+a:e||a||""}hasSubSystem(e){let a=!1;for(const n in e)if(Object.hasOwn(e,n)){const i=e[n];i&&i.status&&(a=!0)}return a}isHealthObject(e){let a=!1;for(const n in e)Object.hasOwn(e,n)&&n==="status"&&(a=!0);return a}}const O=g({compatConfig:{MODE:3},name:"JhiHealthModal",props:{currentHealth:{}},setup(){return{healthService:C("healthService",()=>new k,!0),t$:y().t}},methods:{baseName(t){return this.healthService.getBaseName(t)},subSystemName(t){return this.healthService.getSubSystemName(t)},readableValue(t){if(this.currentHealth.name==="diskSpace"){const e=t/1073741824;return e>1?`${e.toFixed(2)} GB`:`${(t/1048576).toFixed(2)} MB`}return typeof t=="object"?JSON.stringify(t):t.toString()}}}),M={class:"modal-body pad"},B={key:0},j=["textContent"],x={class:"table-responsive"},V={class:"table table-striped","aria-describedby":"Health"},F=["textContent"],J=["textContent"],E={class:"text-left"},z={class:"text-left"},L={key:1},P=["textContent"];function G(t,e,a,n,i,o){return c(),h("div",M,[t.currentHealth&&t.currentHealth.details?(c(),h("div",B,[s("h5",{textContent:l(t.t$("health.details.properties"))},null,8,j),s("div",x,[s("table",V,[s("thead",null,[s("tr",null,[s("th",{class:"text-left",textContent:l(t.t$("health.details.name")),scope:"col"},null,8,F),s("th",{class:"text-left",textContent:l(t.t$("health.details.value")),scope:"col"},null,8,J)])]),s("tbody",null,[(c(!0),h(v,null,N(t.currentHealth.details.details,(m,d)=>(c(),h("tr",{key:d},[s("td",E,l(d),1),s("td",z,l(t.readableValue(m)),1)]))),128))])])])])):p("",!0),t.currentHealth&&t.currentHealth.error?(c(),h("div",L,[s("h4",{textContent:l(t.t$("health.details.error"))},null,8,P),s("pre",null,l(t.currentHealth.error),1)])):p("",!0)])}const I=S(O,[["render",G]]),T=g({compatConfig:{MODE:3},name:"JhiHealth",components:{"health-modal":I},setup(){const t=C("healthService",()=>new k,!0),e=b(null),a=b(null),n=b(!1);return{healthService:t,healthData:e,currentHealth:a,updatingHealth:n,t$:y().t}},mounted(){this.refresh()},methods:{baseName(t){return this.healthService.getBaseName(t)},getBadgeClass(t){return t==="UP"?"badge-success":"badge-danger"},refresh(){this.updatingHealth=!0,this.healthService.checkHealth().then(t=>{this.healthData=this.healthService.transformHealthData(t.data),this.updatingHealth=!1}).catch(t=>{t.status===503&&(this.healthData=this.healthService.transformHealthData(t.error)),this.updatingHealth=!1})},showHealth(t){this.currentHealth=t,this.$refs.healthModal.show()},subSystemName(t){return this.healthService.getSubSystemName(t)}}}),U=["textContent"],q=["disabled"],A=["textContent"],K={class:"table-responsive"},Q={id:"healthCheck",class:"table table-striped","aria-describedby":"Health check"},R=["textContent"],W=["textContent"],X=["textContent"],Y=["textContent"],Z={class:"text-center"},tt=["textContent"],et={class:"text-center"},st=["onClick"],at={key:0,class:"modal-title",id:"showHealthLabel"},nt=["textContent"];function lt(t,e,a,n,i,o){const m=H("font-awesome-icon"),d=H("health-modal"),u=H("b-modal");return c(),h("div",null,[s("h2",null,[s("span",{id:"health-page-heading",textContent:l(t.t$("health.title")),"data-cy":"healthPageHeading"},null,8,U),s("button",{class:"btn btn-primary float-right",onClick:e[0]||(e[0]=r=>t.refresh()),disabled:t.updatingHealth},[f(m,{icon:"sync"}),e[1]||(e[1]=_()),s("span",{textContent:l(t.t$("health['refresh.button']"))},null,8,A)],8,q)]),s("div",K,[s("table",Q,[s("thead",null,[s("tr",null,[s("th",{textContent:l(t.t$("health.table.service")),scope:"col"},null,8,R),s("th",{class:"text-center",textContent:l(t.t$("health.table.status")),scope:"col"},null,8,W),s("th",{class:"text-center",textContent:l(t.t$("health.details.details")),scope:"col"},null,8,X)])]),s("tbody",null,[(c(!0),h(v,null,N(t.healthData,r=>(c(),h("tr",{key:r.name},[s("td",null,[s("span",{textContent:l(t.t$("health.indicator."+t.baseName(r.name)))},null,8,Y),_(" "+l(t.subSystemName(r.name)),1)]),s("td",Z,[s("span",{class:w(["badge",t.getBadgeClass(r.status)]),textContent:l(t.t$("health.status."+r.status))},null,10,tt)]),s("td",et,[r.details||r.error?(c(),h("a",{key:0,class:"hand",onClick:ot=>t.showHealth(r)},[f(m,{icon:"eye"})],8,st)):p("",!0)])]))),128))])])]),f(u,{ref:"healthModal"},{"modal-title":$(()=>[t.currentHealth?(c(),h("h4",at,[s("span",{textContent:l(t.t$("health.indicator."+t.baseName(t.currentHealth.name)))},null,8,nt),_(" "+l(t.subSystemName(t.currentHealth.name)),1)])):p("",!0)]),default:$(()=>[f(d,{"current-health":t.currentHealth},null,8,["current-health"])]),_:1},512)])}const ht=S(T,[["render",lt]]);export{ht as default};
