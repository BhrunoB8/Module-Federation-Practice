import{d as g,j as $,i as v,g as l,u as p,_ as y,c as t,o as n,a as s,b as o,t as r,w as P,l as h,v as w,n as f}from"./index-BApcu5iX.js";import{u as k,s as C,m as b,a as A,r as M}from"./index-B4iRRP_1.js";import"./preload-helper-CLcXU_4U.js";const L=g({compatConfig:{MODE:3},name:"ResetPasswordFinish",validations(){return{resetAccount:{newPassword:{required:M,minLength:A(4),maxLength:b(254)},confirmPassword:{sameAsPassword:C(this.resetAccount.newPassword)}}}},created(){this.$route?.query?.key!==void 0&&(this.key=this.$route.query.key),this.keyMissing=!this.key},setup(){const e=v("loginService"),a=l(null),d=l(null),c=l(null),u=l(!1),m=l(null),i=l({newPassword:null,confirmPassword:null});return{openLogin:()=>{e.openLogin()},doNotMatch:a,success:d,error:c,keyMissing:u,key:m,resetAccount:i,v$:k(),t$:p().t}},methods:{finishReset(){if(this.doNotMatch=null,this.success=null,this.error=null,this.resetAccount.newPassword!==this.resetAccount.confirmPassword)this.doNotMatch="ERROR";else return $.post("api/account/reset-password/finish",{key:this.key,newPassword:this.resetAccount.newPassword}).then(()=>{this.success="OK"}).catch(()=>{this.success=null,this.error="ERROR"})}}}),_={class:"row justify-content-center"},R={class:"col-md-8"},q=["textContent"],N=["innerHTML"],D={key:1,class:"alert alert-danger"},T=["textContent"],V={key:2,class:"alert alert-success"},E=["innerHTML"],H=["textContent"],O={key:3,class:"alert alert-danger"},S=["textContent"],j={key:4,class:"alert alert-warning"},B=["textContent"],F={key:5},U={class:"form-group"},z=["textContent"],I=["placeholder"],K={key:0},G=["textContent"],J=["textContent"],Q=["textContent"],W={class:"form-group"},X=["textContent"],Y=["placeholder"],Z={key:0},x=["textContent"],ee=["disabled","textContent"];function se(e,a,d,c,u,m){return n(),t("div",null,[s("div",_,[s("div",R,[s("h1",{textContent:r(e.t$("reset.request.title"))},null,8,q),e.keyMissing?(n(),t("div",{key:0,class:"alert alert-danger",innerHTML:e.t$("reset.finish.messages.keymissing")},null,8,N)):o("",!0),e.error?(n(),t("div",D,[s("p",{textContent:r(e.t$("reset.finish.messages.error"))},null,8,T)])):o("",!0),e.success?(n(),t("div",V,[s("span",{innerHTML:e.t$("reset.finish.messages.success")},null,8,E),s("a",{class:"alert-link",onClick:a[0]||(a[0]=(...i)=>e.openLogin&&e.openLogin(...i)),textContent:r(e.t$("global.messages.info.authenticated.link"))},null,8,H)])):o("",!0),e.doNotMatch?(n(),t("div",O,[s("p",{textContent:r(e.t$("global.messages.error.dontmatch"))},null,8,S)])):o("",!0),!e.success&&!e.keyMissing?(n(),t("div",j,[s("p",{textContent:r(e.t$("reset.finish.messages.info"))},null,8,B)])):o("",!0),e.keyMissing?o("",!0):(n(),t("div",F,[e.success?o("",!0):(n(),t("form",{key:0,name:"form",onSubmit:a[3]||(a[3]=P(i=>e.finishReset(),["prevent"]))},[s("div",U,[s("label",{class:"form-control-label",for:"newPassword",textContent:r(e.t$("global.form['newpassword.label']"))},null,8,z),h(s("input",{type:"password",class:f(["form-control",{valid:!e.v$.resetAccount.newPassword.$invalid,invalid:e.v$.resetAccount.newPassword.$invalid}]),id:"newPassword",name:"newPassword",placeholder:e.t$("global.form['newpassword.placeholder']"),"onUpdate:modelValue":a[1]||(a[1]=i=>e.v$.resetAccount.newPassword.$model=i),minlength:"4",maxlength:"50",required:"","data-cy":"resetPassword"},null,10,I),[[w,e.v$.resetAccount.newPassword.$model]]),e.v$.resetAccount.newPassword.$anyDirty&&e.v$.resetAccount.newPassword.$invalid?(n(),t("div",K,[e.v$.resetAccount.newPassword.required?o("",!0):(n(),t("small",{key:0,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.newpassword.required"))},null,8,G)),e.v$.resetAccount.newPassword.minLength?o("",!0):(n(),t("small",{key:1,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.newpassword.minlength"))},null,8,J)),e.v$.resetAccount.newPassword.maxLength?o("",!0):(n(),t("small",{key:2,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.newpassword.maxlength"))},null,8,Q))])):o("",!0)]),s("div",W,[s("label",{class:"form-control-label",for:"confirmPassword",textContent:r(e.t$("global.form['confirmpassword.label']"))},null,8,X),h(s("input",{type:"password",class:f(["form-control",{valid:!e.v$.resetAccount.confirmPassword.$invalid,invalid:e.v$.resetAccount.confirmPassword.$invalid}]),id:"confirmPassword",name:"confirmPassword",placeholder:e.t$("global.form['confirmpassword.placeholder']"),"onUpdate:modelValue":a[2]||(a[2]=i=>e.v$.resetAccount.confirmPassword.$model=i),minlength:"4",maxlength:"50",required:"","data-cy":"confirmResetPassword"},null,10,Y),[[w,e.v$.resetAccount.confirmPassword.$model]]),e.v$.resetAccount.confirmPassword.$anyDirty&&e.v$.resetAccount.confirmPassword.$invalid?(n(),t("div",Z,[e.v$.resetAccount.confirmPassword.sameAsPassword?o("",!0):(n(),t("small",{key:0,class:"form-text text-danger",textContent:r(e.t$("global.messages.error.dontmatch"))},null,8,x))])):o("",!0)]),s("button",{type:"submit",disabled:e.v$.resetAccount.$invalid,class:"btn btn-primary",textContent:r(e.t$("password.form.button")),"data-cy":"submit"},null,8,ee)],32))]))])])])}const ae=y(L,[["render",se]]);export{ae as default};
